# Configuración de seguridad para el Sistema CDA

# Proteger archivos sensibles
<Files "config.php">
    Order allow,deny
    Deny from all
</Files>

<Files "*.sql">
    Order allow,deny
    Deny from all
</Files>

# Prevenir acceso directo a archivos de includes
<Files "includes/*.php">
    Order allow,deny
    Deny from all
</Files>

# Configuración de seguridad general
Options -Indexes
ServerTokens Prod

# Headers de seguridad
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Configuración de PHP
<IfModule mod_php.c>
    php_flag display_errors On
    php_flag log_errors On
    php_flag display_startup_errors On
    php_value error_reporting E_ALL
    php_value error_log /var/www/html/siscda/logs/php_errors.log
</IfModule>

# Configuración alternativa para PHP-FPM
<IfModule mod_fastcgi.c>
    php_flag display_errors On
    php_flag log_errors On
    php_flag display_startup_errors On
    php_value error_reporting E_ALL
    php_value error_log /var/www/html/siscda/logs/php_errors.log
</IfModule>

# Redirección de errores
ErrorDocument 403 /siscda/index.php
ErrorDocument 404 /siscda/index.php

# Configuración adicional para debugging
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Permitir acceso a archivos de debug
    RewriteRule ^(test_debug_personas|setup_logs|migrate_database)\.php$ - [L]
    
    # Permitir acceso a directorio de logs
    RewriteRule ^logs/ - [L]
</IfModule>
